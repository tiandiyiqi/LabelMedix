# é¡¹ç›®æœç´¢åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

ä¸º LabelMedix é¡¹ç›®ç®¡ç†ç³»ç»Ÿæ·»åŠ äº†å®Œæ•´çš„é¡¹ç›®æœç´¢åŠŸèƒ½ï¼Œæ”¯æŒæŒ‰å·¥å•åç§°å’Œæè¿°è¿›è¡Œæ¨¡ç³Šæœç´¢ã€‚

## å®æ–½æ—¥æœŸ

2025 å¹´ 10 æœˆ 15 æ—¥

## åŠŸèƒ½ç‰¹æ€§

### 1. æœç´¢èŒƒå›´

- âœ… **å·¥å•åç§°æœç´¢**ï¼šæ”¯æŒå·¥å•åç§°çš„æ¨¡ç³ŠåŒ¹é…
- âœ… **å·¥å•æè¿°æœç´¢**ï¼šæ”¯æŒå·¥å•æè¿°çš„æ¨¡ç³ŠåŒ¹é…
- âœ… **å®æ—¶æœç´¢**ï¼šè¾“å…¥å…³é”®è¯å³æ—¶æ˜¾ç¤ºæœç´¢ç»“æœ
- âœ… **å¤§å°å†™ä¸æ•æ„Ÿ**ï¼šæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™ï¼ˆMySQL é»˜è®¤ï¼‰

### 2. ç”¨æˆ·ç•Œé¢

#### æœç´¢è¾“å…¥æ¡†

- ä½ç½®ï¼šé¡¹ç›®ç®¡ç†é¡µé¢é¡¶éƒ¨
- å ä½ç¬¦æ–‡å­—ï¼š`æœç´¢é¡¹ç›®ï¼ˆå·¥å•åç§°æˆ–æè¿°ï¼‰...`
- å›¾æ ‡ï¼šæœç´¢å›¾æ ‡ï¼ˆå·¦ä¾§ï¼‰
- æ ·å¼ï¼šåœ†è§’ã€é˜´å½±ã€ç„¦ç‚¹çŠ¶æ€

#### æœç´¢çŠ¶æ€

**åŠ è½½ä¸­çŠ¶æ€ï¼š**

```
[åŠ è½½åŠ¨ç”»å›¾æ ‡]
åŠ è½½ä¸­...
```

**ç©ºç»“æœçŠ¶æ€ï¼š**

```
æœªæ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®

[æ¸…é™¤æœç´¢] æŒ‰é’®
```

**æ­£å¸¸ç»“æœï¼š**

- æ˜¾ç¤ºåŒ¹é…çš„é¡¹ç›®åˆ—è¡¨
- æ¯ä¸ªé¡¹ç›®æ˜¾ç¤ºï¼šå·¥å•åç§°ã€ç»Ÿè®¡ä¿¡æ¯ã€çŠ¶æ€ã€æ“ä½œæŒ‰é’®

### 3. äº¤äº’é€»è¾‘

1. **è¾“å…¥å…³é”®è¯**

   - ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯
   - `onChange` äº‹ä»¶è§¦å‘ `handleSearch` å‡½æ•°
   - ç«‹å³è°ƒç”¨åç«¯ API è¿›è¡Œæœç´¢

2. **æ¸…ç©ºæœç´¢**

   - å½“æœç´¢ç»“æœä¸ºç©ºæ—¶ï¼Œæ˜¾ç¤º"æ¸…é™¤æœç´¢"æŒ‰é’®
   - ç‚¹å‡»æŒ‰é’®æ¸…ç©ºæœç´¢æ¡†å¹¶é‡æ–°åŠ è½½å…¨éƒ¨é¡¹ç›®

3. **æœç´¢ä¿æŒ**
   - æœç´¢å…³é”®è¯ä¿å­˜åœ¨ç»„ä»¶çŠ¶æ€ä¸­
   - é¡µé¢ä¸åˆ·æ–°æ—¶æœç´¢çŠ¶æ€ä¿æŒ

## æŠ€æœ¯å®ç°

### åç«¯å®ç°

#### 1. æ§åˆ¶å™¨æ›´æ–°ï¼ˆ`BackEnd/src/controllers/projectController.js`ï¼‰

```javascript
// è·å–é¡¹ç›®åˆ—è¡¨ï¼ˆåˆ†é¡µã€æœç´¢ã€ç­›é€‰ï¼‰
exports.getProjects = async (req, res) => {
  try {
    const page = parseInt(req.query.page) || 1;
    const limit = parseInt(req.query.limit) || 10;
    const offset = (page - 1) * limit;
    const status = req.query.status;
    const search = req.query.search; // æ–°å¢æœç´¢å‚æ•°

    const where = {};
    if (status) {
      where.status = status;
    }

    // æœç´¢åŠŸèƒ½ï¼šæ”¯æŒå·¥å•åç§°å’Œæè¿°æ¨¡ç³Šæœç´¢
    if (search) {
      const { Op } = require("sequelize");
      where[Op.or] = [
        { job_name: { [Op.like]: `%${search}%` } },
        { job_description: { [Op.like]: `%${search}%` } },
      ];
    }

    // ... å…¶ä½™ä»£ç 
  }
};
```

**å…³é”®ç‚¹ï¼š**

- ä½¿ç”¨ Sequelize çš„ `Op.or` æ“ä½œç¬¦å®ç°å¤šå­—æ®µæœç´¢
- ä½¿ç”¨ `Op.like` å®ç°æ¨¡ç³ŠåŒ¹é…
- `%${search}%` å®ç°å…¨æ–‡æ¨¡ç³Šæœç´¢

#### 2. Bug ä¿®å¤

**é—®é¢˜ï¼š** TranslationItem.count ç¼ºå°‘ `as` å…³é”®å­—

```javascript
// ä¿®å¤å‰
const translationCount = await TranslationItem.count({
  include: [
    {
      model: CountryTranslationGroup,
      where: { project_id: project.id },
      attributes: [],
    },
  ],
});

// ä¿®å¤å
const translationCount = await TranslationItem.count({
  include: [
    {
      model: CountryTranslationGroup,
      as: "group", // æ·»åŠ  as å…³é”®å­—
      where: { project_id: project.id },
      attributes: [],
    },
  ],
});
```

### å‰ç«¯å®ç°

#### 1. API æ¨¡å—æ›´æ–°ï¼ˆ`FrontEnd/lib/projectApi.ts`ï¼‰

```typescript
/**
 * è·å–é¡¹ç›®åˆ—è¡¨
 * @param page é¡µç 
 * @param limit æ¯é¡µæ•°é‡
 * @param status é¡¹ç›®çŠ¶æ€ç­›é€‰
 * @param search æœç´¢å…³é”®è¯ï¼ˆå·¥å•åç§°æˆ–æè¿°ï¼‰
 */
export const getProjects = async (
  page: number = 1,
  limit: number = 10,
  status?: 'draft' | 'processing' | 'completed' | 'failed',
  search?: string
): Promise<{
  projects: Project[];
  pagination: {...};
}> => {
  try {
    const params = new URLSearchParams({
      page: page.toString(),
      limit: limit.toString(),
    });

    if (status) {
      params.append('status', status);
    }

    if (search && search.trim()) {
      params.append('search', search.trim());
    }

    // ... å…¶ä½™ä»£ç 
  }
};
```

#### 2. ç»„ä»¶æ›´æ–°ï¼ˆ`FrontEnd/app/components/ProjectList.tsx`ï¼‰

**æ–°å¢çŠ¶æ€ï¼š**

```typescript
const [searchKeyword, setSearchKeyword] = useState("");
```

**æ›´æ–°åŠ è½½å‡½æ•°ï¼š**

```typescript
// åŠ è½½é¡¹ç›®åˆ—è¡¨
const loadProjects = async (search?: string) => {
  try {
    setIsLoading(true);
    const { projects: projectList } = await getProjects(
      1,
      100,
      undefined,
      search
    );
    setProjects(projectList);
  } catch (error) {
    console.error("åŠ è½½é¡¹ç›®åˆ—è¡¨å¤±è´¥:", error);
  } finally {
    setIsLoading(false);
  }
};

// å¤„ç†æœç´¢
const handleSearch = (value: string) => {
  setSearchKeyword(value);
  loadProjects(value);
};
```

**æ›´æ–°æœç´¢æ¡†ï¼š**

```tsx
<input
  type="text"
  placeholder="æœç´¢é¡¹ç›®ï¼ˆå·¥å•åç§°æˆ–æè¿°ï¼‰..."
  value={searchKeyword}
  onChange={(e) => handleSearch(e.target.value)}
  className="w-full pl-10 pr-4 py-2 rounded-lg shadow-sm focus:outline-none focus:ring-2 transition-shadow"
  style={{
    borderColor: theme.border,
    backgroundColor: "white",
    color: theme.text,
  }}
/>
```

**æ·»åŠ çŠ¶æ€å¤„ç†ï¼š**

```tsx
{
  isLoading ? (
    <div className="text-center py-8">
      <Loader2
        className="h-8 w-8 animate-spin mx-auto"
        style={{ color: theme.primary }}
      />
      <p className="mt-2" style={{ color: theme.subtext }}>
        åŠ è½½ä¸­...
      </p>
    </div>
  ) : projects.length === 0 ? (
    <div className="text-center py-12">
      <p className="text-lg" style={{ color: theme.subtext }}>
        {searchKeyword ? "æœªæ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®" : "æš‚æ— é¡¹ç›®ï¼Œè¯·åˆ›å»ºæ–°é¡¹ç›®"}
      </p>
      {searchKeyword && (
        <button
          onClick={() => {
            setSearchKeyword("");
            loadProjects();
          }}
          className="mt-4 px-4 py-2 rounded-lg text-white"
          style={{ backgroundColor: theme.primary }}
        >
          æ¸…é™¤æœç´¢
        </button>
      )}
    </div>
  ) : (
    <ul className="space-y-2">{/* é¡¹ç›®åˆ—è¡¨ */}</ul>
  );
}
```

## API æ¥å£

### æœç´¢ API

**ç«¯ç‚¹ï¼š** `GET /api/projects`

**æŸ¥è¯¢å‚æ•°ï¼š**

| å‚æ•°   | ç±»å‹   | å¿…å¡« | è¯´æ˜                 |
| ------ | ------ | ---- | -------------------- |
| page   | number | å¦   | é¡µç ï¼ˆé»˜è®¤ï¼š1ï¼‰      |
| limit  | number | å¦   | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ï¼š10ï¼‰ |
| status | string | å¦   | é¡¹ç›®çŠ¶æ€ç­›é€‰         |
| search | string | å¦   | æœç´¢å…³é”®è¯           |

**ç¤ºä¾‹è¯·æ±‚ï¼š**

```bash
# æœç´¢å·¥å•åç§°åŒ…å« "001" çš„é¡¹ç›®
GET /api/projects?search=001

# æœç´¢å¹¶æŒ‰çŠ¶æ€ç­›é€‰
GET /api/projects?search=NZ&status=completed

# æœç´¢å¹¶åˆ†é¡µ
GET /api/projects?search=test&page=1&limit=20
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "data": {
    "projects": [
      {
        "id": 1,
        "job_name": "001",
        "job_description": null,
        "status": "processing",
        "total_files": 0,
        "user_id": null,
        "createdAt": "2025-10-15T02:17:13.000Z",
        "updatedAt": "2025-10-15T02:17:13.000Z",
        "creator": null,
        "statistics": {
          "countryCount": 0,
          "translationCount": 0
        }
      }
    ],
    "pagination": {
      "total": 1,
      "page": 1,
      "limit": 10,
      "totalPages": 1
    }
  }
}
```

**ç©ºç»“æœå“åº”ï¼š**

```json
{
  "success": true,
  "data": {
    "projects": [],
    "pagination": {
      "total": 0,
      "page": 1,
      "limit": 10,
      "totalPages": 0
    }
  }
}
```

## æµ‹è¯•éªŒè¯

### åç«¯æµ‹è¯•

**1. æµ‹è¯•æœç´¢å­˜åœ¨çš„é¡¹ç›®ï¼š**

```bash
curl -s "http://localhost:3001/api/projects?search=001" | python3 -m json.tool
```

**é¢„æœŸç»“æœï¼š** è¿”å›åŒ…å« "001" çš„é¡¹ç›®åˆ—è¡¨ âœ…

**2. æµ‹è¯•æœç´¢ä¸å­˜åœ¨çš„é¡¹ç›®ï¼š**

```bash
curl -s "http://localhost:3001/api/projects?search=notexist" | python3 -m json.tool
```

**é¢„æœŸç»“æœï¼š** è¿”å›ç©ºé¡¹ç›®åˆ—è¡¨ âœ…

**3. æµ‹è¯•ä¸å¸¦æœç´¢å‚æ•°ï¼š**

```bash
curl -s "http://localhost:3001/api/projects" | python3 -m json.tool
```

**é¢„æœŸç»“æœï¼š** è¿”å›æ‰€æœ‰é¡¹ç›® âœ…

### å‰ç«¯æµ‹è¯•

**1. åŸºæœ¬æœç´¢æµ‹è¯•ï¼š**

- [ ] æ‰“å¼€é¡¹ç›®ç®¡ç†é¡µé¢
- [ ] åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯
- [ ] éªŒè¯æ˜¾ç¤ºåŒ¹é…çš„é¡¹ç›®

**2. ç©ºç»“æœæµ‹è¯•ï¼š**

- [ ] è¾“å…¥ä¸å­˜åœ¨çš„å…³é”®è¯
- [ ] éªŒè¯æ˜¾ç¤º"æœªæ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®"
- [ ] éªŒè¯æ˜¾ç¤º"æ¸…é™¤æœç´¢"æŒ‰é’®
- [ ] ç‚¹å‡»"æ¸…é™¤æœç´¢"æŒ‰é’®
- [ ] éªŒè¯æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®

**3. åŠ è½½çŠ¶æ€æµ‹è¯•ï¼š**

- [ ] è¾“å…¥æœç´¢å…³é”®è¯
- [ ] éªŒè¯æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- [ ] éªŒè¯åŠ è½½å®Œæˆåæ˜¾ç¤ºç»“æœ

**4. å®æ—¶æœç´¢æµ‹è¯•ï¼š**

- [ ] é€ä¸ªè¾“å…¥å­—ç¬¦
- [ ] éªŒè¯æ¯æ¬¡è¾“å…¥éƒ½è§¦å‘æœç´¢
- [ ] éªŒè¯ç»“æœå®æ—¶æ›´æ–°

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ–

1. **é˜²æŠ–ï¼ˆDebounceï¼‰**

   ```typescript
   // æ·»åŠ é˜²æŠ–å»¶è¿Ÿï¼Œé¿å…é¢‘ç¹è¯·æ±‚
   const debouncedSearch = useMemo(
     () =>
       debounce((value: string) => {
         loadProjects(value);
       }, 300),
     []
   );

   const handleSearch = (value: string) => {
     setSearchKeyword(value);
     debouncedSearch(value);
   };
   ```

2. **ç¼“å­˜æœç´¢ç»“æœ**

   - ä½¿ç”¨ React Query æˆ– SWR ç¼“å­˜æœç´¢ç»“æœ
   - é¿å…é‡å¤è¯·æ±‚ç›¸åŒçš„æœç´¢å…³é”®è¯

3. **åˆ†é¡µä¼˜åŒ–**
   - å½“å‰å®ç°ä¸€æ¬¡åŠ è½½ 100 æ¡è®°å½•
   - å¯æ”¹ä¸ºçœŸæ­£çš„åˆ†é¡µåŠ è½½

### ä¸­æœŸä¼˜åŒ–

1. **å…¨æ–‡æœç´¢å¼•æ“**

   - é›†æˆ Elasticsearch æˆ– Meilisearch
   - æä¾›æ›´å¿«é€Ÿã€æ›´å¼ºå¤§çš„æœç´¢èƒ½åŠ›

2. **æœç´¢å»ºè®®**

   - æ·»åŠ æœç´¢å»ºè®®ä¸‹æ‹‰åˆ—è¡¨
   - æ˜¾ç¤ºå†å²æœç´¢è®°å½•

3. **é«˜çº§æœç´¢**
   - æ”¯æŒå¤šæ¡ä»¶ç»„åˆæœç´¢
   - æ”¯æŒæ—¥æœŸèŒƒå›´ç­›é€‰
   - æ”¯æŒå›½åˆ«ä»£ç ç­›é€‰

## å·²çŸ¥é™åˆ¶

1. **æœç´¢æ€§èƒ½**

   - å½“é¡¹ç›®æ•°é‡å¾ˆå¤§æ—¶ï¼Œ`LIKE` æŸ¥è¯¢å¯èƒ½è¾ƒæ…¢
   - å»ºè®®ï¼šæ•°æ®åº“è¡¨æ·»åŠ å…¨æ–‡ç´¢å¼•

2. **ç‰¹æ®Šå­—ç¬¦**

   - å½“å‰æœªå¤„ç†ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰
   - å»ºè®®ï¼šæ·»åŠ è¾“å…¥éªŒè¯å’Œè½¬ä¹‰

3. **æœç´¢ç²¾åº¦**
   - `LIKE %keyword%` å¯èƒ½è¿”å›è¿‡å¤šç»“æœ
   - å»ºè®®ï¼šæ·»åŠ ç›¸å…³æ€§æ’åº

## æ–‡ä»¶æ¸…å•

### ä¿®æ”¹æ–‡ä»¶

1. **`BackEnd/src/controllers/projectController.js`**

   - æ·»åŠ æœç´¢åŠŸèƒ½æ”¯æŒ
   - ä¿®å¤ TranslationItem.count é”™è¯¯

2. **`FrontEnd/lib/projectApi.ts`**

   - æ›´æ–° `getProjects` å‡½æ•°ç­¾å
   - æ·»åŠ  search å‚æ•°å¤„ç†

3. **`FrontEnd/app/components/ProjectList.tsx`**
   - æ·»åŠ  `searchKeyword` çŠ¶æ€
   - å®ç° `handleSearch` å‡½æ•°
   - æ›´æ–°æœç´¢æ¡†ç»‘å®š
   - æ·»åŠ åŠ è½½å’Œç©ºçŠ¶æ€å¤„ç†

### æ–°å¢æ–‡ä»¶

1. **`æœç´¢åŠŸèƒ½è¯´æ˜.md`** - æœ¬æ–‡æ¡£

## æ€»ç»“

âœ… **å®Œæˆçš„åŠŸèƒ½ï¼š**

- åç«¯æœç´¢ API æ”¯æŒ
- å‰ç«¯æœç´¢ç•Œé¢
- å®æ—¶æœç´¢
- åŠ è½½çŠ¶æ€
- ç©ºç»“æœå¤„ç†
- Bug ä¿®å¤

ğŸš€ **å»ºè®®çš„åç»­ä¼˜åŒ–ï¼š**

- æœç´¢é˜²æŠ–
- æœç´¢ç»“æœç¼“å­˜
- é«˜çº§æœç´¢é€‰é¡¹
- å…¨æ–‡æœç´¢å¼•æ“é›†æˆ

---

**å®æ–½æ—¥æœŸï¼š** 2025 å¹´ 10 æœˆ 15 æ—¥  
**å®æ–½å›¢é˜Ÿï¼š** ç„é‰´ AI å›¢é˜Ÿ  
**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.0

---

# ç„é‰´ï¼ï¼ï¼ç„é‰´ï¼ï¼ï¼ç„é‰´ç¼–ç¨‹ï¼Œä½¿å‘½å¿…è¾¾ï¼ï¼ï¼ï¼ï¼ï¼ï¼
