# LabelMedix 快速启动指南

## 前置要求

- Docker Desktop（MySQL 容器）
- Node.js 20.x
- cnpm 或 npm

## 一键启动步骤

### 1. 启动 Docker MySQL 容器

```bash
# 如果容器已存在但未运行
docker start authmatrix_mysql

# 验证容器状态
docker ps | grep mysql
```

### 2. 启动后端服务

```bash
# 进入后端目录
cd /Users/Tiandiyiqi/Documents/Prepress/LabelMedix/BackEnd

# 启动开发服务器
npm run dev
```

后端服务将在 `http://localhost:3001` 启动

### 3. 启动前端服务

```bash
# 新开一个终端窗口
cd /Users/Tiandiyiqi/Documents/Prepress/LabelMedix/FrontEnd

# 启动开发服务器
npm run dev
```

前端服务将在 `http://localhost:3000` 启动

### 4. 访问应用

打开浏览器访问：`http://localhost:3000`

## 验证服务状态

### 验证后端服务

```bash
# 健康检查
curl http://localhost:3001/health

# 测试项目列表 API
curl http://localhost:3001/api/projects
```

### 验证数据库连接

```bash
# 查看数据库表
docker exec authmatrix_mysql mysql -u root -proot123 labelmedix_dev -e "SHOW TABLES;"

# 查看项目数据
docker exec authmatrix_mysql mysql -u root -proot123 labelmedix_dev -e "SELECT * FROM Projects;"
```

## 常见问题解决

### 问题 1：后端端口被占用

```bash
# 停止占用 3001 端口的进程
lsof -ti:3001 | xargs kill -9

# 重新启动后端
cd BackEnd && npm run dev
```

### 问题 2：前端端口被占用

```bash
# 停止占用 3000 端口的进程
lsof -ti:3000 | xargs kill -9

# 重新启动前端
cd FrontEnd && npm run dev
```

### 问题 3：数据库连接失败

```bash
# 检查 MySQL 容器状态
docker ps | grep mysql

# 如果容器未运行，启动容器
docker start authmatrix_mysql

# 检查 BackEnd/.env 配置
cat BackEnd/.env
```

确保以下配置正确：

```env
DB_USERNAME=root
DB_PASSWORD=root123
DB_NAME=labelmedix_dev
DB_HOST=localhost
DB_PORT=3306
```

### 问题 4：需要重置数据库

```bash
cd BackEnd

# 回滚所有迁移
npm run db:migrate:undo:all

# 重新执行迁移
npm run db:migrate
```

## 开发流程

### 新建项目流程

1. 打开前端页面：`http://localhost:3000`
2. 点击"新建项目"按钮
3. 上传 PDF 文件
4. 输入工单名称（如：NZ-8864-4396-101）
5. 点击"解析并创建项目"
6. 等待 Coze API 解析完成
7. 项目自动保存到数据库
8. 在项目列表中查看新创建的项目

### 查看项目详情

1. 在项目列表中点击项目卡片
2. 查看各国别代码的翻译结果
3. 可以编辑翻译内容
4. 保存更改

## 数据库结构

```
Projects (项目表)
├── id
├── job_name (工单名称，唯一)
├── job_description
├── status (draft/processing/completed/failed)
├── total_files
└── user_id

CountryTranslationGroups (国别翻译组表)
├── id
├── project_id
├── country_code (国别代码，如 AU, CN, MD, NZ)
├── sequence_number (序号，项目内唯一)
└── total_items

TranslationItems (翻译详情表)
├── id
├── group_id
├── field_type (basic_info/number_field/drug_description)
├── original_text
├── translated_text
├── item_order
└── is_edited
```

## API 端点

### 项目管理

- `GET /api/projects` - 获取项目列表（支持分页）
- `GET /api/projects/:id` - 获取项目详情
- `POST /api/projects` - 创建新项目
- `PUT /api/projects/:id` - 更新项目
- `DELETE /api/projects/:id` - 删除项目

### 翻译管理

- `GET /api/projects/:projectId/translations/:countryCode` - 获取特定国别的翻译
- `PUT /api/projects/translations/:itemId` - 更新翻译内容

## 环境配置文件

### BackEnd/.env

```env
# 数据库配置
DB_USERNAME=root
DB_PASSWORD=root123
DB_NAME=labelmedix_dev
DB_HOST=localhost
DB_PORT=3306

# JWT配置
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=24h

# 服务器配置
PORT=3001
NODE_ENV=development
```

### FrontEnd/.env.local

```env
# Coze API 配置
COZE_API_KEY=your_coze_api_key
COZE_BOT_ID=your_bot_id
COZE_WORKFLOW_ID=your_workflow_id

# 后端 API 配置
NEXT_PUBLIC_API_BASE_URL=http://localhost:3001
```

## 技术栈

### 后端

- Node.js 20.x
- Express.js
- Sequelize ORM
- MySQL 8.0 (Docker)

### 前端

- Next.js 14
- TypeScript
- React
- TailwindCSS
- Shadcn/ui

### 外部服务

- Coze API（AI 解析）
- Docker（MySQL 容器）

---

**文档版本：** 1.0
**最后更新：** 2025 年 10 月 15 日
**维护团队：** 玄鉴 AI 团队
