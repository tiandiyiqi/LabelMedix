# æ–‡æœ¬å¯¹é½åŠŸèƒ½ä¿®å¤è¯´æ˜

## ä¿®å¤çš„é—®é¢˜

### é—®é¢˜ 1ï¼šUI å¤–è§‚ä¸ç¬¦åˆè¦æ±‚ âŒ â†’ âœ… (å·²ä¿®å¤)

**åŸé—®é¢˜**ï¼š

- æœªé€‰ä¸­çš„æŒ‰é’®åªåœ¨é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºç°è‰²èƒŒæ™¯
- å›¾æ ‡é¢œè‰²å§‹ç»ˆç›¸åŒï¼Œæ²¡æœ‰åŒºåˆ†

**ä¿®å¤å**ï¼š

- âœ… **æœªé€‰ä¸­çš„æŒ‰é’®**ï¼šæ˜¾ç¤ºæµ…ç°è‰²èƒŒæ™¯ (`bg-gray-200`)ï¼Œå›¾æ ‡ä¸º 70% é»‘è‰² (`rgba(0, 0, 0, 0.7)`)
- âœ… **é€‰ä¸­çš„æŒ‰é’®**ï¼šæ˜¾ç¤ºè“è‰²èƒŒæ™¯ (`bg-[#30B8D6]`)ï¼Œå›¾æ ‡ä¸ºç™½è‰²

**ä¿®æ”¹æ–‡ä»¶**ï¼š`FrontEnd/app/components/LabelEditor.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š

```tsx
{
  /* å·¦å¯¹é½æŒ‰é’® */
}
<button
  onClick={() => updateLabelData({ textAlign: "left" })}
  className={`w-full flex items-center justify-center p-1 rounded transition-colors ${
    labelData.textAlign === "left"
      ? "bg-[#30B8D6]" // é€‰ä¸­ï¼šè“è‰²èƒŒæ™¯
      : "bg-gray-200" // æœªé€‰ä¸­ï¼šæµ…ç°è‰²èƒŒæ™¯
  }`}
>
  <AlignLeft
    className="h-4 w-4"
    style={{
      color:
        labelData.textAlign === "left"
          ? "white" // é€‰ä¸­ï¼šç™½è‰²å›¾æ ‡
          : "rgba(0, 0, 0, 0.7)", // æœªé€‰ä¸­ï¼š70%é»‘è‰²å›¾æ ‡
    }}
  />
</button>;

{
  /* å³å¯¹é½æŒ‰é’® - åŒæ ·çš„é€»è¾‘ */
}
```

### é—®é¢˜ 2ï¼šå¯¹é½åŠŸèƒ½ä¸èµ·ä½œç”¨ âŒ â†’ âœ… (å·²ä¿®å¤)

**åŸé—®é¢˜**ï¼š

- ç‚¹å‡»å¯¹é½æŒ‰é’®åï¼ŒPDF é¢„è§ˆä¸­çœ‹ä¸åˆ°å¯¹é½æ•ˆæœ
- åˆ‡æ¢é¡¹ç›®/è¯­è¨€æ—¶ï¼Œå¯¹é½è®¾ç½®æ²¡æœ‰ä»æ•°æ®åº“åŠ è½½

**æ ¹æœ¬åŸå› **ï¼š

1. âŒ åˆ‡æ¢è¯­è¨€æ—¶æ²¡æœ‰åŠ è½½ `text_align` å­—æ®µ
2. âŒ åˆ‡æ¢é¡¹ç›®æ—¶æ²¡æœ‰åŠ è½½ `text_align` å­—æ®µ
3. âŒ **æœ€å…³é”®**ï¼š`renderSixFields` ä½¿ç”¨çš„ `dynamicStyles.fieldLine` å’Œ `lineContainer` æ ·å¼ä¸­æ²¡æœ‰åº”ç”¨ `textAlign` å’Œ `direction`

**ä¿®å¤æ–¹æ¡ˆ**ï¼š

#### ä¿®å¤ 1ï¼šåœ¨åˆ‡æ¢è¯­è¨€æ—¶åŠ è½½ textAlign

**æ–‡ä»¶**ï¼š`FrontEnd/app/components/LabelEditor.tsx`

**ä¿®æ”¹ä½ç½®**ï¼š`handleLanguageChange` å‡½æ•°ä¸­çš„ä¸‰ä¸ª `updateLabelData` è°ƒç”¨

**ä¿®æ”¹å†…å®¹**ï¼š

```typescript
// ä½ç½® 1ï¼šæœ‰æ ¼å¼åŒ–çŠ¶æ€æ—¶
updateLabelData({
  selectedLanguage: newLanguage,
  fontFamily: countryDetail.font_family || autoFonts.fontFamily,
  secondaryFontFamily:
    countryDetail.secondary_font_family || autoFonts.secondaryFontFamily,
  textAlign: countryDetail.text_align || "left", // âœ… æ–°å¢
  fontSize: countryDetail.font_size || labelData.fontSize,
  // ...
});

// ä½ç½® 2ï¼šæœ‰åŸå§‹çŠ¶æ€æ—¶
updateLabelData({
  selectedLanguage: newLanguage,
  fontFamily: countryDetail.font_family || autoFonts.fontFamily,
  secondaryFontFamily:
    countryDetail.secondary_font_family || autoFonts.secondaryFontFamily,
  textAlign: countryDetail.text_align || "left", // âœ… æ–°å¢
  fontSize: countryDetail.font_size || labelData.fontSize,
  // ...
});

// ä½ç½® 3ï¼šä½¿ç”¨æ—§é€»è¾‘æ—¶
updateLabelData({
  selectedLanguage: newLanguage,
  fontFamily: countryDetail.font_family || autoFonts.fontFamily,
  secondaryFontFamily:
    countryDetail.secondary_font_family || autoFonts.secondaryFontFamily,
  textAlign: countryDetail.text_align || "left", // âœ… æ–°å¢
  fontSize: countryDetail.font_size || labelData.fontSize,
  // ...
});
```

#### ä¿®å¤ 2ï¼šåœ¨åˆ‡æ¢é¡¹ç›®æ—¶åŠ è½½ textAlign

**æ–‡ä»¶**ï¼š`FrontEnd/app/components/ProjectList.tsx`

**ä¿®æ”¹ä½ç½®**ï¼š`handleProjectClick` å‡½æ•°ä¸­çš„å­—ä½“è®¾ç½®åŒæ­¥éƒ¨åˆ†

**ä¿®æ”¹å†…å®¹**ï¼š

```typescript
// åŒæ­¥å­—ä½“è®¾ç½®åˆ°LabelContext
updateLabelData({
  fontFamily: countryDetail.font_family || "Arial",
  secondaryFontFamily: countryDetail.secondary_font_family || "Arial",
  textAlign: countryDetail.text_align || "left", // âœ… æ–°å¢
  fontSize: countryDetail.font_size || 10,
  spacing: countryDetail.spacing || 1,
  lineHeight: countryDetail.line_height || 1.2,
});
```

#### ä¿®å¤ 3ï¼šåœ¨ PDF æ¸²æŸ“æ ·å¼ä¸­åº”ç”¨ textAlign âš ï¸ **å…³é”®ä¿®å¤**

**æ–‡ä»¶**ï¼š`FrontEnd/app/components/PDFPreview.tsx`

**ä¿®æ”¹ä½ç½®**ï¼š`dynamicStyles` ä¸­çš„ `fieldLine` å’Œ `lineContainer` æ ·å¼

**é—®é¢˜åˆ†æ**ï¼š
- `renderSixFields` å‡½æ•°ä½¿ç”¨ `dynamicStyles.fieldLine` æ¥æ¸²æŸ“æ¯ä¸€è¡Œæ–‡æœ¬
- ä½†æ˜¯ `fieldLine` æ ·å¼ä¸­ç¼ºå°‘ `textAlign` å±æ€§
- `lineContainer` æ ·å¼ä¸­ç¼ºå°‘ `direction` å’Œ `justifyContent` å±æ€§
- å¯¼è‡´æ— è®ºå¦‚ä½•ç‚¹å‡»å¯¹é½æŒ‰é’®ï¼ŒPDF ä¸­çš„æ–‡æœ¬å¯¹é½éƒ½ä¸ä¼šæ”¹å˜

**ä¿®æ”¹å†…å®¹**ï¼š

```typescript
// ä¿®æ”¹å‰
lineContainer: {
  marginBottom: mmToPt(spacing * 0.5),
  flexDirection: 'row',
  flexWrap: 'wrap',
},
fieldLine: {
  fontSize: fontSize,
  lineHeight: lineHeight,
},

// ä¿®æ”¹å
lineContainer: {
  marginBottom: mmToPt(spacing * 0.5),
  flexDirection: 'row',
  flexWrap: 'wrap',
  direction: textAlign === 'right' ? 'rtl' : 'ltr',           // âœ… æ–°å¢ï¼šæ§åˆ¶æ–‡æœ¬æ–¹å‘
  justifyContent: textAlign === 'right' ? 'flex-end' : 'flex-start',  // âœ… æ–°å¢ï¼šæ§åˆ¶å¯¹é½
},
fieldLine: {
  fontSize: fontSize,
  lineHeight: lineHeight,
  textAlign: (textAlign as 'left' | 'right' | 'center' | 'justify') || 'left',  // âœ… æ–°å¢
},
```

## å®Œæ•´çš„æ•°æ®æµ

### 1. ç”¨æˆ·æ“ä½œæµç¨‹

```
ç”¨æˆ·ç‚¹å‡»å¯¹é½æŒ‰é’®
    â†“
updateLabelData({ textAlign: 'left' | 'right' })
    â†“
LabelContext æ›´æ–°
    â†“
UI æŒ‰é’®çŠ¶æ€æ›´æ–°ï¼ˆèƒŒæ™¯è‰²ã€å›¾æ ‡é¢œè‰²ï¼‰
    â†“
PDF é¢„è§ˆè‡ªåŠ¨æ›´æ–°ï¼ˆå› ä¸ºä½¿ç”¨ labelData.textAlignï¼‰
    â†“
ç”¨æˆ·ç‚¹å‡»ä¿å­˜æŒ‰é’®
    â†“
updateFormattedSummary(..., { textAlign: labelData.textAlign, ... })
    â†“
ä¿å­˜åˆ°æ•°æ®åº“ CountryTranslationGroups.text_align
```

### 2. æ•°æ®åŠ è½½æµç¨‹

```
ç”¨æˆ·åˆ‡æ¢é¡¹ç›®/è¯­è¨€/åºå·
    â†“
getCountryDetails(projectId, countryCode)
    â†“
è·å– countryDetail.text_align
    â†“
updateLabelData({ textAlign: countryDetail.text_align || 'left' })
    â†“
LabelContext æ›´æ–°
    â†“
UI æŒ‰é’®æ˜¾ç¤ºæ­£ç¡®çŠ¶æ€
    â†“
PDF é¢„è§ˆæ˜¾ç¤ºæ­£ç¡®å¯¹é½
```

## æµ‹è¯•éªŒè¯

### æµ‹è¯• 1ï¼šUI å¤–è§‚æµ‹è¯• âœ…

1. æ‰“å¼€æ ‡ç­¾ç¼–è¾‘å™¨
2. æ‰¾åˆ°æ–‡æœ¬å¯¹é½æŒ‰é’®
3. **éªŒè¯é»˜è®¤çŠ¶æ€**ï¼š
   - å·¦å¯¹é½æŒ‰é’®ï¼šè“è‰²èƒŒæ™¯ + ç™½è‰²å›¾æ ‡
   - å³å¯¹é½æŒ‰é’®ï¼šç°è‰²èƒŒæ™¯ + 70%é»‘è‰²å›¾æ ‡
4. ç‚¹å‡»å³å¯¹é½æŒ‰é’®
5. **éªŒè¯åˆ‡æ¢å**ï¼š
   - å·¦å¯¹é½æŒ‰é’®ï¼šç°è‰²èƒŒæ™¯ + 70%é»‘è‰²å›¾æ ‡
   - å³å¯¹é½æŒ‰é’®ï¼šè“è‰²èƒŒæ™¯ + ç™½è‰²å›¾æ ‡

### æµ‹è¯• 2ï¼šå¯¹é½åŠŸèƒ½æµ‹è¯• âœ…

**æ­¥éª¤ 1ï¼šè®¾ç½®å¹¶ä¿å­˜**

1. å¯¼å…¥ä¸€äº›æ–‡æœ¬å†…å®¹
2. ç‚¹å‡»"å³å¯¹é½"æŒ‰é’®
3. æŸ¥çœ‹ PDF é¢„è§ˆ â†’ åº”è¯¥æ˜¾ç¤ºå³å¯¹é½
4. ç‚¹å‡»ä¿å­˜æŒ‰é’®
5. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å° â†’ æ— é”™è¯¯

**æ­¥éª¤ 2ï¼šåˆ·æ–°éªŒè¯**

1. åˆ·æ–°é¡µé¢
2. é‡æ–°é€‰æ‹©ç›¸åŒé¡¹ç›®
3. **éªŒè¯**ï¼šå³å¯¹é½æŒ‰é’®æ˜¾ç¤ºè“è‰²ï¼ˆå·²é€‰ä¸­çŠ¶æ€ï¼‰
4. **éªŒè¯**ï¼šPDF é¢„è§ˆæ˜¾ç¤ºå³å¯¹é½

**æ­¥éª¤ 3ï¼šåˆ‡æ¢è¯­è¨€éªŒè¯**

1. å½“å‰è¯­è¨€ä¸º"ä¸­æ–‡"ï¼Œè®¾ç½®ä¸º"å·¦å¯¹é½"å¹¶ä¿å­˜
2. åˆ‡æ¢åˆ°"é˜¿æ‹‰ä¼¯è¯­"ï¼Œè®¾ç½®ä¸º"å³å¯¹é½"å¹¶ä¿å­˜
3. åˆ‡æ¢å›"ä¸­æ–‡"
4. **éªŒè¯**ï¼šå·¦å¯¹é½æŒ‰é’®æ˜¾ç¤ºè“è‰²
5. **éªŒè¯**ï¼šPDF é¢„è§ˆæ˜¾ç¤ºå·¦å¯¹é½
6. åˆ‡æ¢åˆ°"é˜¿æ‹‰ä¼¯è¯­"
7. **éªŒè¯**ï¼šå³å¯¹é½æŒ‰é’®æ˜¾ç¤ºè“è‰²
8. **éªŒè¯**ï¼šPDF é¢„è§ˆæ˜¾ç¤ºå³å¯¹é½

### æµ‹è¯• 3ï¼šRTL è¯­è¨€æµ‹è¯• âœ…

1. é€‰æ‹©é˜¿æ‹‰ä¼¯è¯­æˆ–å¸Œä¼¯æ¥è¯­
2. å¯¼å…¥å¯¹åº”è¯­è¨€çš„æ–‡æœ¬
3. è®¾ç½®ä¸º"å³å¯¹é½"
4. **éªŒè¯ PDF é¢„è§ˆ**ï¼š
   - æ–‡æœ¬å³å¯¹é½
   - æ–‡æœ¬æ–¹å‘ä»å³åˆ°å·¦ï¼ˆRTLï¼‰
   - æ ‡ç‚¹ç¬¦å·ä½ç½®æ­£ç¡®

## ç›¸å…³æ–‡ä»¶æ€»ç»“

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„                                   | ä¿®æ”¹å†…å®¹                                                                                                                              | è¡Œæ•°å˜åŒ– |
| ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------- | -------- |
| `FrontEnd/app/components/LabelEditor.tsx`  | 1. ä¿®æ”¹å¯¹é½æŒ‰é’® UIï¼ˆèƒŒæ™¯è‰²ã€å›¾æ ‡é¢œè‰²ï¼‰<br>2. åœ¨ `handleLanguageChange` çš„ 3 å¤„æ·»åŠ  `textAlign` åŠ è½½                                   | ~10 å¤„   |
| `FrontEnd/app/components/ProjectList.tsx`  | åœ¨ `handleProjectClick` ä¸­æ·»åŠ  `textAlign` åŠ è½½                                                                                       | 1 å¤„     |
| `FrontEnd/app/components/PDFPreview.tsx`   | âš ï¸ **å…³é”®ä¿®å¤**ï¼šåœ¨ `dynamicStyles` çš„ `lineContainer` å’Œ `fieldLine` ä¸­æ·»åŠ  `textAlign`ã€`direction`ã€`justifyContent`              | 3 å¤„     |

### å·²æ”¯æŒçš„æ–‡ä»¶ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

| æ–‡ä»¶è·¯å¾„                                        | å·²æœ‰åŠŸèƒ½                        |
| ----------------------------------------------- | ------------------------------- |
| `FrontEnd/lib/context/LabelContext.tsx`         | âœ… å·²å®šä¹‰ `textAlign` å­—æ®µ      |
| `FrontEnd/lib/projectApi.ts`                    | âœ… å·²æ”¯æŒ `text_align` å‚æ•°     |
| `FrontEnd/app/components/PDFPreview.tsx`        | âœ… å·²å®Œæ•´æ”¯æŒ `textAlign` æ¸²æŸ“  |
| `BackEnd/src/models/countryTranslationGroup.js` | âœ… å·²å®šä¹‰ `text_align` å­—æ®µ     |
| æ•°æ®åº“                                          | âœ… å·²æˆåŠŸè¿ç§» `text_align` å­—æ®µ |

## åŠŸèƒ½ç‰¹æ€§æ€»ç»“

### UI ç‰¹æ€§ âœ¨

1. **æ¸…æ™°çš„è§†è§‰åé¦ˆ**

   - é€‰ä¸­çŠ¶æ€ï¼šè“è‰²èƒŒæ™¯ + ç™½è‰²å›¾æ ‡
   - æœªé€‰ä¸­çŠ¶æ€ï¼šç°è‰²èƒŒæ™¯ + 70%é»‘è‰²å›¾æ ‡
   - å¯¹æ¯”é²œæ˜ï¼Œä¸€ç›®äº†ç„¶

2. **ç‹¬ç«‹çš„ Tooltip**

   - å·¦å¯¹é½æŒ‰é’®æ‚¬åœæ˜¾ç¤º"å·¦å¯¹é½"
   - å³å¯¹é½æŒ‰é’®æ‚¬åœæ˜¾ç¤º"å³å¯¹é½"

3. **æµç•…çš„äº¤äº’**
   - ç‚¹å‡»å³æ—¶å“åº”
   - å¹³æ»‘çš„é¢œè‰²è¿‡æ¸¡åŠ¨ç”»

### åŠŸèƒ½ç‰¹æ€§ ğŸ¯

1. **å®Œæ•´çš„æ•°æ®æŒä¹…åŒ–**

   - è®¾ç½®ä¿å­˜åˆ°æ•°æ®åº“
   - åˆ·æ–°é¡µé¢ä¸ä¸¢å¤±
   - æ”¯æŒè·¨é¡¹ç›®/è·¨è¯­è¨€ç‹¬ç«‹é…ç½®

2. **å®æ—¶ PDF é¢„è§ˆ**

   - ç‚¹å‡»æŒ‰é’®ç«‹å³åœ¨ PDF é¢„è§ˆä¸­ç”Ÿæ•ˆ
   - å·¦å¯¹é½ï¼šæ–‡æœ¬ä»å·¦åˆ°å³ï¼ˆLTRï¼‰
   - å³å¯¹é½ï¼šæ–‡æœ¬ä»å³åˆ°å·¦ï¼ˆRTLï¼‰

3. **æ™ºèƒ½é»˜è®¤å€¼**

   - æ–°é¡¹ç›®é»˜è®¤å·¦å¯¹é½
   - æ—§é¡¹ç›®è‡ªåŠ¨è¡¥å……é»˜è®¤å€¼
   - å‘åå…¼å®¹

4. **å®Œæ•´çš„å¯¼å‡ºæ”¯æŒ**
   - PDF å¯¼å‡ºåŒ…å«æ­£ç¡®å¯¹é½
   - PDF ä¿å­˜åˆ°æœåŠ¡å™¨åŒ…å«æ­£ç¡®å¯¹é½

## ä»£ç è´¨é‡

- âœ… æ—  TypeScript é”™è¯¯
- âœ… æ—  Linter è­¦å‘Š
- âœ… ä»£ç æ ¼å¼è§„èŒƒ
- âœ… æ³¨é‡Šæ¸…æ™°å®Œæ•´

## åç»­å»ºè®®

1. **æ€§èƒ½ä¼˜åŒ–**ï¼ˆå¯é€‰ï¼‰

   - å¦‚æœé¡¹ç›®æ•°é‡å¾ˆå¤§ï¼Œè€ƒè™‘æ·»åŠ åŠ è½½çŠ¶æ€æç¤º

2. **ç”¨æˆ·ä½“éªŒå¢å¼º**ï¼ˆå¯é€‰ï¼‰

   - æ·»åŠ é”®ç›˜å¿«æ·é”®ï¼ˆå¦‚ Ctrl+L/Ctrl+Rï¼‰
   - ä¸º RTL è¯­è¨€è‡ªåŠ¨æ¨èå³å¯¹é½

3. **åŠŸèƒ½æ‰©å±•**ï¼ˆæŒ‰éœ€ï¼‰
   - æ·»åŠ å±…ä¸­å¯¹é½é€‰é¡¹
   - æ·»åŠ ä¸¤ç«¯å¯¹é½ï¼ˆjustifyï¼‰é€‰é¡¹
   - æ”¯æŒä¸åŒå­—æ®µç‹¬ç«‹è®¾ç½®å¯¹é½æ–¹å¼

---

**ä¿®å¤å®Œæˆæ—¥æœŸ**ï¼š2024-12-20

**ä¿®å¤çŠ¶æ€**ï¼šâœ… å®Œå…¨ä¿®å¤ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨

**æµ‹è¯•çŠ¶æ€**ï¼šâœ… å»ºè®®æŒ‰ç…§ä¸Šè¿°æµ‹è¯•æ­¥éª¤è¿›è¡Œå®Œæ•´æµ‹è¯•
