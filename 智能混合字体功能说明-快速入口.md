# 智能混合字体功能 - 快速入口

## 🎯 功能简介

**智能混合字体功能**允许在同一句话中，中文和英文自动使用不同的字体，无需手动分离字符。

### 核心特性

- ✅ 自动识别字符类型（中文、英文、数字等）
- ✅ 智能应用不同字体
- ✅ 保持 PDF 中文本为可编辑对象（不转曲线）
- ✅ 完全兼容 Adobe Illustrator
- ✅ **根据国别语言自动选择最佳字体组合** (v1.1.0 新增)

---

## 📚 完整文档位置

所有详细文档位于：`FrontEnd/` 目录

### 快速导航

#### 📖 用户使用说明

**文件**: `FrontEnd/智能混合字体使用说明.md`  
**内容**: 详细的使用教程、配置方法、常见问题

#### 🛠️ 技术实施文档

**文件**: `FrontEnd/智能混合字体功能总结.md`  
**内容**: 技术细节、代码位置、实现原理

#### 📊 PDF 方案对比

**文件**: `FrontEnd/pdf方案总结.md`  
**内容**: 所有测试方案、技术决策、优化记录

#### 🗂️ 文档导航中心

**文件**: `FrontEnd/PDF与字体功能文档导航.md`  
**内容**: 所有文档的导航和快速查询

---

## 🚀 快速开始

### 1. 打开标签编辑器

进入药品标签编辑界面

### 2. 字体自动选择（推荐）✨

**系统会根据选择的国别语言自动设置最佳字体组合**，无需手动选择！

| 语言/国别         | 主语言字体       | 次语言字体       | 说明                              |
| ----------------- | ---------------- | ---------------- | --------------------------------- |
| 中文 (CN)         | STHeiti          | Arial            | 中文使用黑体，英文/数字使用 Arial |
| 日文 (JP)         | Arial Unicode MS | Arial Unicode MS | 统一使用 Unicode 字体             |
| 韩文 (KR)         | Arial Unicode MS | Arial Unicode MS | 统一使用 Unicode 字体             |
| 意大利语 (IT)     | Arial            | Arial            | 统一使用 Arial                    |
| 阿拉伯语/希伯来语 | Arial Unicode MS | Arial Unicode MS | RTL 语言使用 Unicode 字体         |
| 其他欧洲语言      | Arial            | Arial            | 统一使用 Arial                    |

**使用方法**：

1. 选择国别语言（如 "JP Japan/Japanese"）
2. 系统自动设置对应字体
3. 导入翻译内容后，字体自动匹配

### 3. 手动设置字体（可选）

如需自定义，可在"字体相关参数"区域手动调整：

- **主语言字体**: 用于主语言字符（如中文、日文、韩文）
- **次语言字体**: 用于英文、数字等拉丁字符

**示例**：中文环境

- **主语言字体**: `STHeiti`（用于中文）
- **次语言字体**: `Arial`（用于英文）

### 4. 输入混合文本

例如：`研究者：Dr. Smith`

### 5. 预览和导出

- 点击"预览"查看效果
- 点击"导出 PDF"保存文件

**结果**:

- "研究者：" 自动使用主语言字体（如 STHeiti 黑体）
- "Dr. Smith" 自动使用次语言字体（如 Arial）

---

## ❓ 常见问题

### Q: 为什么需要两个字体？

**A**: 中文字体（如黑体）的英文字符不够标准，英文字体（如 Arial）不包含中文字符。分离设置让每种语言使用最佳字体。

### Q: 字体会自动选择吗？

**A**: 是的！系统会根据选择的国别语言自动设置最佳字体组合：

- 中文 → STHeiti / Arial
- 日文/韩文 → Arial Unicode MS / Arial Unicode MS
- 意大利语等欧洲语言 → Arial / Arial
- 阿拉伯语/希伯来语 → Arial Unicode MS / Arial Unicode MS

### Q: 我可以手动修改字体吗？

**A**: 可以！手动修改后，系统会记住您的选择，不会被自动选择覆盖。

### Q: 数字用哪个字体？

**A**: 数字自动使用次语言字体（通常是 Arial），因为更清晰标准。

### Q: 在 Adobe Illustrator 中文字会分离吗？

**A**: 在字体切换点会产生多个文本对象（PDF 规范特性），但文本仍然可编辑，不会转为路径。

### Q: 切换国别后字体变了怎么办？

**A**: 这是正常的！不同国别有不同的最佳字体。如需统一字体，可以手动设置后点击"保存"。

---

## 📞 需要更多帮助？

查看完整文档：

```
cd FrontEnd
open PDF与字体功能文档导航.md
```

或直接查看：

- [FrontEnd/智能混合字体使用说明.md](FrontEnd/智能混合字体使用说明.md)
- [FrontEnd/智能混合字体功能总结.md](FrontEnd/智能混合字体功能总结.md)
- [FrontEnd/pdf 方案总结.md](FrontEnd/pdf方案总结.md)

---

## 🔧 技术说明

### 字体自动选择机制

**核心原理**：

1. **语言检测**：系统根据国别代码（如 CN、JP、KR、IT）识别语言
2. **智能匹配**：自动选择该语言的最佳字体组合
3. **优先级规则**：
   - 用户手动设置的字体 > 自动选择的字体
   - 数据库中为 `NULL` 的字体 → 使用自动选择
   - 数据库中有明确值的字体 → 使用数据库值（用户已修改过）

**数据存储**：

- `CountryTranslationGroup` 表：存储翻译内容和字体设置
- 字体字段为 `NULL` 时，表示使用自动选择
- 字体字段有值时，表示用户手动设置过

**修复历史**（v1.1.0）：

- ✅ 移除了 `LabelSettings` 表中的字体字段干扰
- ✅ 清除了数据库中的硬编码默认值
- ✅ 实现了真正的"智能选择"机制
- ✅ 修复了切换国别后字体错误的问题

---

**版本**: v1.1.0  
**实施日期**: 2025-10-17 (v1.0.0) | 2025-11-21 (v1.1.0)  
**团队**: 玄鉴 AI 团队

**玄鉴！！！玄鉴！！！玄鉴编程，使命必达！！！！！！！**
