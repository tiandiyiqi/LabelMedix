# CMYK 颜色模式测试说明

## 1. 概述

本测试文档用于验证 `@react-pdf/renderer` 是否支持 CMYK 颜色模式。CMYK 是印刷行业的标准颜色模式，对于药品标签等印刷品至关重要。

---

## 2. 使用方法

### 2.1 启动测试页面

1. **启动开发服务器**：

   ```bash
   cd FrontEnd
   npm run dev
   ```

2. **访问测试页面**：
   打开浏览器访问：`http://localhost:3000/test-cmyk`

3. **导出 PDF**：
   点击页面顶部的"导出 PDF"按钮，下载测试文件

### 2.2 验证 CMYK 支持

#### 方法一：使用 Adobe Acrobat Pro（推荐）

1. 用 Adobe Acrobat Pro 打开导出的 PDF
2. 点击菜单：**文件 → 属性 → 高级**
3. 查看"颜色空间"信息
4. 如果显示"DeviceCMYK"或"CMYK"，说明支持 CMYK

#### 方法二：使用预检功能

1. 在 Adobe Acrobat Pro 中打开 PDF
2. 点击菜单：**工具 → 印刷制作 → 预检**
3. 查看"颜色空间"报告
4. 应该能看到 CMYK 颜色对象

#### 方法三：使用输出预览

1. 在 Adobe Acrobat Pro 中打开 PDF
2. 点击菜单：**工具 → 印刷制作 → 输出预览**
3. 查看分色预览
4. 应该能看到 C（青）、M（品红）、Y（黄）、K（黑）四个分色通道

---

## 3. 测试内容

### 3.1 CMYK 纯色测试

测试文档包含四种 CMYK 纯色：

| 颜色           | CMYK 值               | 说明                       |
| -------------- | --------------------- | -------------------------- |
| 青色 (Cyan)    | C:100% M:0% Y:0% K:0% | 纯青色，印刷中的基本色之一 |
| 品红 (Magenta) | C:0% M:100% Y:0% K:0% | 纯品红，印刷中的基本色之一 |
| 黄色 (Yellow)  | C:0% M:0% Y:100% K:0% | 纯黄色，印刷中的基本色之一 |
| 黑色 (Black)   | C:0% M:0% Y:0% K:100% | 纯黑色，印刷中的基本色之一 |

### 3.2 CMYK 混合色测试

测试文档还包含三种混合色：

- **C:50% M:50% Y:0% K:0%** - 青色+品红混合
- **C:0% M:50% Y:50% K:0%** - 品红+黄色混合
- **C:50% M:0% Y:50% K:0%** - 青色+黄色混合

### 3.3 文本和背景测试

- **文本颜色**：使用 CMYK 颜色作为文字颜色
- **背景颜色**：使用 CMYK 颜色作为背景色块

---

## 4. 预期结果

### 4.1 如果支持 CMYK

✅ **特征**：

- PDF 文档属性中显示 CMYK 颜色空间
- 预检工具能识别 CMYK 对象
- 输出预览中能看到 C、M、Y、K 四个分色通道
- 颜色显示正确，无明显色差

### 4.2 如果不支持 CMYK

❌ **特征**：

- PDF 文档使用 RGB 颜色空间
- CMYK 值被转换为 RGB
- 输出预览只有复合通道，没有分色
- 可能存在色彩偏差

---

## 5. CMYK 函数实现

### 5.1 代码示例

```typescript
// CMYK颜色辅助函数
const cmyk = (c: number, m: number, y: number, k: number) => {
  return `cmyk(${c}, ${m}, ${y}, ${k})`;
};

// 使用示例
const styles = StyleSheet.create({
  cmykCyan: {
    color: cmyk(1, 0, 0, 0), // 纯青色
  },
  cmykMagenta: {
    color: cmyk(0, 1, 0, 0), // 纯品红
  },
  cmykYellow: {
    color: cmyk(0, 0, 1, 0), // 纯黄色
  },
  cmykBlack: {
    color: cmyk(0, 0, 0, 1), // 纯黑色
  },
});
```

### 5.2 参数说明

- **c (Cyan)**: 青色，范围 0-1（0% 到 100%）
- **m (Magenta)**: 品红，范围 0-1（0% 到 100%）
- **y (Yellow)**: 黄色，范围 0-1（0% 到 100%）
- **k (Black)**: 黑色，范围 0-1（0% 到 100%）

---

## 6. 常见问题

### Q1: 为什么浏览器中预览的颜色和印刷品不一样？

**A**: 浏览器使用 RGB 颜色模式显示，而印刷使用 CMYK 模式。即使 PDF 内部是 CMYK，浏览器预览时也会转换为 RGB。这是正常现象。

### Q2: 如何确保印刷时颜色准确？

**A**:

1. 使用专业的印刷预检工具验证 PDF
2. 与印刷厂确认色彩标准（如 ISO Coated v2）
3. 如果可能，要求提供打样样本
4. 避免使用过于鲜艳的颜色（印刷色域小于屏幕）

### Q3: RGB 和 CMYK 可以混用吗？

**A**:

- 技术上可以，但不推荐
- 印刷时所有颜色最终都会转换为 CMYK
- 最好在设计阶段就使用 CMYK，避免色彩转换带来的偏差

---

## 7. 技术细节

### 7.1 @react-pdf/renderer CMYK 支持

根据 `@react-pdf/renderer` 官方文档：

- ✅ 支持 `cmyk()` 函数定义颜色
- ✅ 可以在 `color` 和 `backgroundColor` 中使用
- ⚠️ 浏览器预览时会转换为 RGB（仅供参考）
- ✅ 导出的 PDF 文件保持 CMYK 颜色空间

### 7.2 颜色转换公式

从 RGB 转换到 CMYK（简化公式）：

```
K = 1 - max(R, G, B)
C = (1 - R - K) / (1 - K)
M = (1 - G - K) / (1 - K)
Y = (1 - B - K) / (1 - K)
```

### 7.3 印刷注意事项

1. **总墨量控制**：C+M+Y+K 不应超过 300-320%
2. **黑色文字**：使用单黑（K:100%），不要使用四色黑
3. **纯白色**：C:0% M:0% Y:0% K:0%（不是 RGB 白色）
4. **陷印设置**：确保套印准确，避免露白

---

## 8. 文件结构

```
FrontEnd/
├── app/
│   ├── components/
│   │   └── CMYKTestDocument.tsx    # CMYK测试组件
│   └── test-cmyk/
│       └── page.tsx                 # 测试页面
└── CMYK测试说明.md                  # 本文档
```

---

## 9. 相关资源

### 9.1 官方文档

- [React PDF Renderer 官方文档](https://react-pdf.org/)
- [PDF 规范 - 颜色空间](https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf)

### 9.2 印刷标准

- ISO 12647-2：胶版印刷色彩标准
- GRACoL：美国商业印刷标准
- FOGRA39 / FOGRA51：欧洲印刷标准

### 9.3 工具推荐

- **Adobe Acrobat Pro**：专业 PDF 查看和编辑
- **Adobe InDesign**：专业排版软件
- **Enfocus PitStop**：PDF 预检和编辑插件

---

## 10. 下一步行动

### 10.1 如果测试通过（支持 CMYK）

✅ 可以直接在项目中使用 CMYK 颜色模式：

1. 在 `PDFPreview.tsx` 中应用 CMYK 颜色
2. 更新颜色选择器，支持 CMYK 输入
3. 为客户提供 CMYK 色值参考
4. 与印刷厂确认色彩标准

### 10.2 如果测试失败（不支持 CMYK）

❌ 需要寻找替代方案：

1. **方案 A**：使用 RGB 设计，印刷前转换为 CMYK

   - 优点：开发简单
   - 缺点：可能有色差，需要人工校正

2. **方案 B**：使用后期处理工具转换

   - 使用 Ghostscript 等工具将 PDF 转换为 CMYK
   - 集成到导出流程中

3. **方案 C**：使用专业 PDF 库
   - 考虑使用 PDFKit 或其他支持 CMYK 的库
   - 可能需要重写部分代码

---

## 11. 总结

本测试文档通过生成包含 CMYK 颜色的 PDF 文件，验证 `@react-pdf/renderer` 的 CMYK 支持能力。测试结果将直接影响项目的技术选型和实现方案。

**测试步骤**：

1. ✅ 创建测试组件
2. ✅ 生成测试 PDF
3. ⏳ 使用专业工具验证
4. ⏳ 根据结果调整实施方案

---

**创建时间**：2025-10-23  
**版本**：v1.0  
**维护者**：玄鉴开发团队
